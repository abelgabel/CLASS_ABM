# Call packages#
library(network)#
# Call functions#
getwd()#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
#
# Select three active actors#
sample(1:N,3, replace=F)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
Time_s<-5000#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}
plotg_alliance<-function(actors, threshold){#
N<-length(actors)#
# Layout#
  l<-matrix(0,nrow=N,ncol=2)#
for(i in 1:N){#
  l[i,]<-c(cos(2*(i-1)*pi/N),2*sin(2*(i-1)*pi/N))#
}#
#
# Create Network#
coallitions<-matrix(0,nrow=N,ncol=N)#
rownames(coallitions)<-1:N#
colnames(coallitions)<-1:N#
#
for(k in 1:N){#
for(k2 in c(1:N)[-k]){#
#
coallitions[k,k2]<- if(actors[[k]]$commitment[k2]>=threshold) 1 else 0#
}}#
netw<-graph_from_adjacency_matrix(coallitions)#
wealth_all<-history_track$wealth[Time_s,]/max(history_track$wealth[Time_s,])#
netw <-set_vertex_attr(netw, 'wealth', index = 1:N, wealth_all)#
#
# plot#
plot.igraph(netw, vertex.size=30*V(netw)$wealth,edge.arrow.size=0.01, layout=l)#
}
# Call packages#
library(network)#
# Call functions#
getwd()#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
#
# Select three active actors#
sample(1:N,3, replace=F)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}
plotg_alliance<-function(actors, threshold){#
N<-length(actors)#
# Layout#
  l<-matrix(0,nrow=N,ncol=2)#
for(i in 1:N){#
  l[i,]<-c(cos(2*(i-1)*pi/N),2*sin(2*(i-1)*pi/N))#
}#
#
# Create Network#
coallitions<-matrix(0,nrow=N,ncol=N)#
rownames(coallitions)<-1:N#
colnames(coallitions)<-1:N#
#
for(k in 1:N){#
for(k2 in c(1:N)[-k]){#
#
coallitions[k,k2]<- if(actors[[k]]$commitment[k2]>=threshold) 1 else 0#
}}#
netw<-graph_from_adjacency_matrix(coallitions)#
wealth_all<-history_track$wealth[Time_s,]/max(history_track$wealth[Time_s,])#
netw <-set_vertex_attr(netw, 'wealth', index = 1:N, wealth_all)#
#
# plot#
plot.igraph(netw, vertex.size=30*V(netw)$wealth,edge.arrow.size=0.01, layout=l)#
}
plotg_alliance(actors,.6)
library(igraph)
plotg_alliance(actors,.6)
plot_com(c(2,5,9,18),history_track$wealth)#
#
plot_com<-function(actors_c, wealth){#
#
all_values<-wealth[, actors_c[i]]#
for(i in 2:length(actors_c))#
{#
	all_values<-c(all_values, wealth[, actors_c[i]])#
	}#
max_v<-max(all_values)#
plot(history_track$wealth[, actors_c[1]], type='l', ylim=c(0, max_v), xlab='Time',ylab='Wealth')#
lines(wealth[, actors_c[2]], col='red')#
lines(wealth[, actors_c[3]], col='green')#
lines(wealth[, actors_c[4]], col='blue')#
legend('topleft',legend=c('Actors',actors_c[1], actors_c[2], actors_c[3], actors_c[4]),#
lty=c(0,1,1,1,1), col=c('','black','red','green','blue'))#
#
}
plot_com(c(2,5,9,18),history_track$wealth)
plot_com(c(2,5,9,2),history_track$wealth)
plot_com(c(2,5,9,1),history_track$wealth)
plot_com(c(2,5,9,3),history_track$wealth)
plot_com(c(2,5,6,3),history_track$wealth)
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
#
history_track$actors<-actors#
return(history_track)#
#
}
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
#
history_track$actors<-actors#
return(history_track)#
#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
library(shiny)
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	# ni<-length(alliance_i[,'id'])#
	# ni2<-ni-1#
	# nj<-length(alliance_j[,'id'])#
	# nj2<-nj-1#
# #  for(k in 1:ni2){#
 	 	# ni3<-k+1#
 	# for(k2 in ni:ni){#
 		# i1<-alliance_i[,'id'][k]#
 		# i2<-alliance_i[,'id'][k2]#
 		# actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		# actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	# }#
 # }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
# #  for(k in 1:ni2){#
 	 	# ni3<-k+1#
 	# for(k2 in ni:ni){#
 		# i1<-alliance_i[,'id'][k]#
 		# i2<-alliance_i[,'id'][k2]#
 		# actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		# actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	# }#
 # }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
# #  for(k in 1:ni2){#
 	 	# ni3<-k+1#
 	# for(k2 in ni:ni){#
 		# i1<-alliance_i[,'id'][k]#
 		# i2<-alliance_i[,'id'][k2]#
 		# actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		# actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	# }#
 # }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
  for(k in 1:ni2){#
 	 	ni3<-k+1#
 	for(k2 in ni:ni){#
 		i1<-alliance_i[,'id'][k]#
 		i2<-alliance_i[,'id'][k2]#
 		actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	}#
 # }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
  for(k in 1:ni2){#
 	 	ni3<-k+1#
 	for(k2 in ni:ni){#
 		i1<-alliance_i[,'id'][k]#
 		i2<-alliance_i[,'id'][k2]#
 		actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	}#
  }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
  for(k in 1:ni2){#
 	 	ni3<-k+1#
 	for(k2 in n3:ni){#
 		i1<-alliance_i[,'id'][k]#
 		i2<-alliance_i[,'id'][k2]#
 		actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	}#
  }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
  # for(k in 1:ni2){#
 	 	# ni3<-k+1#
 	# for(k2 in n3:ni){#
 		# i1<-alliance_i[,'id'][k]#
 		# i2<-alliance_i[,'id'][k2]#
 		# actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		# actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	# }#
  # }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni2){#
 	 	 ni3<-k+1#
 	 for(k2 in n3:ni){#
 		# i1<-alliance_i[,'id'][k]#
 		# i2<-alliance_i[,'id'][k2]#
 		# actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		# actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(1)	#
  # for(k in 1:ni2){#
 	 	# ni3<-k+1#
 	# for(k2 in n3:ni){#
 		# i1<-alliance_i[,'id'][k]#
 		# i2<-alliance_i[,'id'][k2]#
 		# actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		# actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	# }#
  # }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
  # for(k in 1:ni2){#
 	 	# ni3<-k+1#
 	# for(k2 in n3:ni){#
 		# i1<-alliance_i[,'id'][k]#
 		# i2<-alliance_i[,'id'][k2]#
 		# actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		# actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	# }#
  # }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
 # for(k in 1:ni){#
 	# for(k2 in 1:nj){#
 		# i1<-alliance_i[,'id'][k]#
 		# j1<-alliance_j[,'id'][k2]#
 		# actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		# actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	# }#
 # }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
for(i in 4:4){print(i)}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
  # for(k in 1:ni2){#
 	 	# ni3<-k+1#
 	# for(k2 in n3:ni){#
 		# i1<-alliance_i[,'id'][k]#
 		# i2<-alliance_i[,'id'][k2]#
 		# actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		# actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	# }#
  # }	#
 # for(k in 1:nj2){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
#
history_track$actors<-actors#
return(history_track)#
#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
plotg_alliance(history_track,.6)#
plotg_alliance<-function(history_track, threshold){#
	actors<-history_track$actors#
	Time_s<-nrow(history_track$wealth)#
    N<-length(actors)#
# Layout#
  l<-matrix(0,nrow=N,ncol=2)#
for(i in 1:N){#
  l[i,]<-c(cos(2*(i-1)*pi/N),2*sin(2*(i-1)*pi/N))#
}#
#
# Create Network#
coallitions<-matrix(0,nrow=N,ncol=N)#
rownames(coallitions)<-1:N#
colnames(coallitions)<-1:N#
#
for(k in 1:N){#
for(k2 in c(1:N)[-k]){#
#
coallitions[k,k2]<- if(actors[[k]]$commitment[k2]>=threshold) 1 else 0#
}}#
netw<-graph_from_adjacency_matrix(coallitions)#
wealth_all<-history_track$wealth[Time_s,]/max(history_track$wealth[Time_s,])#
netw <-igraph::set_vertex_attr(netw, 'wealth', index = 1:N, wealth_all)#
#
# plot#
plot.igraph(netw, vertex.size=30*V(netw)$wealth,edge.arrow.size=0.01, layout=l)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
   for(k in 1:ni){#
 	 	 ni3<-k+1#
 	 for(k2 in n3:ni){#
 		 i1<-alliance_i[,'id'][k]#
 		 i2<-alliance_i[,'id'][k2]#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
 # for(k in 1:nj){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
   for(k in 1:ni){#
 	 	 ni3<-k+1#
 	 for(k2 in ni3:ni){#
 		 i1<-alliance_i[,'id'][k]#
 		 i2<-alliance_i[,'id'][k2]#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
 # for(k in 1:nj){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
   for(k in 1:ni){#
 	 	 ni3<-k+1#
 	 for(k2 in ni3:ni){#
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
 # for(k in 1:nj){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
   for(k in 1:ni){#
 	 	 ni3<-k+1#
 	 for(k2 in ni3:ni){#
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
 # for(k in 1:nj){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
k
k2
k2<-2
print(k+k2)
print(k); print(k2)
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
   for(k in 1:ni){#
 	 	 ni3<-k+1#
 	 for(k2 in ni3:ni){print(k); print(k2)#
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
 # for(k in 1:nj){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
   for(k in 1:ni){#
 	 	 ni3<-k+1#
 	 for(k2 in k:ni){print(k); print(k2)#
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
 # for(k in 1:nj){#
 	# nj3<-k+1#
 	# for(k2 in nj3:nj2){#
 		# j1<-alliance_j[,'id'][k]#
 		# j2<-alliance_j[,'id'][k2]#
 		# actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		# actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	# }#
 # }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
   for(k in 1:ni){#
 	 	 ni3<-k+1#
 	 for(k2 in k:ni){print(k); print(k2)#
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 nj3<-k+1#
 	 for(k2 in nj3:nj2){#
 		 j1<-alliance_j[,'id'][k]#
 		 j2<-alliance_j[,'id'][k2]#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
   for(k in 1:ni){#
 	 for(k2 in k:ni){print(k); print(k2)#
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[,'id'][k]#
 		 j2<-alliance_j[,'id'][k2]#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
print(ni)#
print(ni2)#
print(nj)#
print(nj2)#
   for(k in 1:ni){#
 	 for(k2 in k:ni){print(k); print(k2)#
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){print(k); print(k2)#
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[,'id'][k]#
 		 j1<-alliance_j[,'id'][k2]#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[k,'id']#
 		 j1<-alliance_j[k2,'id']#
 		 actors[[i1]]$commitment[j1]<-max(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-max(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
print(time_s)#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
#
history_track$actors<-actors#
return(history_track)#
#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 i1<-alliance_i[k,'id']#
 		 j1<-alliance_j[k2,'id']#
 		 actors[[i1]]$commitment[j1]<-min(actors[[i1]]$commitment[j1]-10,0)#
 		 actors[[j1]]$commitment[i1]<-min(actors[[j1]]$commitment[i1]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-min(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-min(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
		actors[[i]]$commitment[j]<-max(actors[[i]]$commitment[j]-10,0)#
		actors[[j]]$commitment[i]<-max(actors[[j]]$commitment[i]-10,0)#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
	print(alliance_i); print(alliance_j)#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-min(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-min(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
#	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
#	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
	print(alliance_i); print(alliance_j)#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-min(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-min(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
#	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
#	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 print(ic); print(jc)#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
#	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
#	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 print(paste0(ic,' ,',jc)#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
#	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
#	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 print(paste0(ic,' ,',jc))#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
#
history_track$actors<-actors#
return(history_track)#
#
}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
#	actors[[k]]$commitment[i]<-min(actors[[k]]$commitment[i]+10,100)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
#	actors[[k]]$commitment[j]<-min(actors[[k]]$commitment[j]+10,100)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	ni2<-ni-1#
	nj<-length(alliance_j[,'id'])#
	nj2<-nj-1#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 print(paste0(ic,' ,',jc))#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
#
history_track$actors<-actors#
return(history_track)#
print('s')#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[j]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
$
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[j]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[j]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
fight=0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+10# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .25*total_weath_i>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
# Select Number of Actors#
# N<-10#
#
# Create initial Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
#
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .25*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .15*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .05*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .15*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Fight or not?#
fight= .10*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Fight or not?#
fight= .15*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
# Output#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
# Create Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+10#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
# Update actors' information#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
# Output#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
# Create Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+10#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
# Update actors' information#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
#
# Fight or not?#
fight= .15*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .15*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
# Output#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
# Create Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+10#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
# Update actors' information#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .15*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
# Create Wealth#
# #####################################################	 #
# In the water-cut gullies the earth dusted down in dry little streams.#
# Gophers and ant lions started small avalanches. And as the sharp sun struck day after day, the leaves of the young corn became less stiff and erect; they bent in a curve at first, and then, as the central ribs of strength grew weak, each leaf tilted downward. #
#Then it was June, and the sun shone more fiercely. The brown lines on the corn leaves widened and moved in on the central ribs.#
# #####################################################	 #
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Initia Conditions#
######################################
Wealth<-runif(N,min=300, max=500)#
# Total Wealth#
t_Wealth<-sum(Wealth)#
#
# Create Actors#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
#Time_s<-500#
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
##
# #####################################################	 #
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
####
# Choose active actors#
active<-sample(1:N,3, replace=F)#
#
# Choose target actors #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
Wealth<-rep(0,N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .15*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
Wealth<-rep(0,N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
Wealth<-rep(0,N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
Wealth<-rep(0,N)#
#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
Wealth<-rep(0,N)#
#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
Wealth<-runif(N,min=300, max=500)#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+20# Wealth[i]#
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
#
#Extract information#
#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .10*total_weath_i*(actors[[j]]$wealth/ total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .10*total_weath_i*(actors[[j]]$wealth/total_weath_j)>150  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .10*total_weath_i*(actors[[j]]$wealth/total_weath_j)>150  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,-100)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,-100)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
Wealth<-runif(N,min=300, max=500)#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+5 #
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
# Output#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
plot_com<-function(actors_c, wealth){#
#
all_values<-wealth[, actors_c]#
for(i in 1:length(actors_c))#
{#
	all_values<-c(all_values, wealth[, actors_c[i]])#
	}#
max_v<-max(all_values)#
plot(wealth[, actors_c[1]], type='l', ylim=c(0, max_v), xlab='Time',ylab='Wealth', xlim=c(0,nrow(wealth)))#
lines(wealth[, actors_c[2]], col='red')#
#lines(wealth[, actors_c[3]], col='green')#
#lines(wealth[, actors_c[4]], col='blue')#
legend('topleft',legend=c('Actors',actors_c[1], actors_c[2]),#
lty=c(0,1,1), col=c('','black','red'))#
#legend('topleft',legend=c('Actors',actors_c[1], actors_c[2], actors_c[3], actors_c[4]),#
#lty=c(0,1,1,1,1), col=c('','black','red','green','blue'))#
#
}
# Call packages#
library(igraph)#
# Call functions#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Actors/actor_function.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/alliance_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/target_actor.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/Updating_process/updating_f.R")#
#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_trends.R")#
source("/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model/plot_alliance_net.R")#
setting_simulate<-function(N, Time_s){#
######################################
# Create Actors#
######################################
Wealth<-runif(N,min=300, max=500)#
actors<-list()#
for(i in 1:N){#
	actors[[i]]<-actor(position=i,Wealth[i],rep(0,N))#
}#
# #####################################################	 #
##
# #####################################################	 #
#
history_track<-list()#
history_track$wealth<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-rep(0,Time_s)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
history_track$active<-list()#
history_track$active$active<-matrix(0,nrow=Time_s, ncol=6)#
history_track$active$alliance<-matrix(0,nrow=Time_s,ncol=N)#
# #####################################################	 #
# Start Simulations#
# #####################################################	 #
#
for(time_s in 1:Time_s){#
#
if(time_s!=1){#
# Star of new Year#
Wealth<-runif(N,min=300, max=500)#
#
for(i in 1:N){#
	actors[[i]]$wealth<-actors[[i]]$wealth+5 #
}#
}#
# #####################################################	 #
# Choose active actors#
# #####################################################	 #
active<-sample(1:N,3, replace=F)#
#
# #####################################################	 #
# Choose target actors #
# #####################################################	 #
target<-rep(0,3)#
for(i in 1:3){#
	target[i]<-target_actor(active[i],actors)#
	history_track$active$active[time_s,i]<-active[i]#
	history_track$active$active[time_s,3+i]<-target[i]#
}#
# Update actors#
if(!is.na(target[i])){#
	forming_alliance(active[i],target[i],actors)#
	actors<-update_process(active[i], target[i],actors)#
}#
#
#Track Wealth#
for(actor_s in 1:N){#
history_track$wealth[time_s,actor_s]<-actors[[actor_s]]$wealth#
}#
}#
print('s')#
#
history_track$actors<-actors#
# Output#
return(history_track)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
.5>250
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .10*total_weath_i*(actors[[j]]$wealth/total_weath_j)<250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
.5<250
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .20*total_weath_i*(actors[[j]]$wealth/total_weath_j)<250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
.5<250
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .20*total_weath_i*(actors[[j]]$wealth/total_weath_j)>250   #
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
.5<250
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
update_process<-function(i,j, actors){#
# ######################################################
# Hamlet:#
# Fight or not to fight, that is the question:#
# Whether 'tis nobler in the mind to suffer#
# The slings and arrows of outrageous fortune,#
# Or to take Arms against a Sea of troubles, 	#
# #####################################################	 #
# Fight or not?#
	alliance_i<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==i,]#
	 total_weath_i<-forming_alliance(i,j,actors)$wealth1#
alliance_j<-forming_alliance(i,j,actors)$alliance[forming_alliance(i,j,actors)$alliance[,'allied']==j,]#
	total_weath_j<-forming_alliance(i,j,actors)$wealth2#
fight= .10*total_weath_i*(actors[[j]]$wealth/total_weath_j)>250  # 0.25*actors[[i]]$wealth>250 # Either true or false#
	# Decision not to fight#
	if(fight){ # There is no fight#
	  # Update wealth #
	  # gets tribute#
	actors[[i]]$wealth<-actors[[i]]$wealth+min(actors[[j]]$wealth,250)#
	# pays tribute#
	actors[[j]]$wealth<-actors[[j]]$wealth-min(actors[[j]]$wealth,250)#
	# Update Commitment: #
	# Protection#
	actors[[i]]$commitment[j]<-min(actors[[i]]$commitment[j]+10,100)#
	# Subservience#
	actors[[j]]$commitment[i]<-min(actors[[j]]$commitment[i]+10,100)#
	}#
#
# Decision to fight:#
# #####################################################	 #
# Caeser:#
# Cowards die many times before their deaths; #
# The valiant never taste of death but once.#
# It seems to me most strange that men should fear; #
# Seeing that death, a necessary end, #
# Will come when it will come#
# #####################################################	 #
	else{#
		#####################
		# Alliances:#
		#####################
# Cost and commitment update: Alliance i:#
 for(k in alliance_i[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_i[alliance_i[,'id']==k,'wealth']-#
	(alliance_i[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_j*.25,0)#
	}#
# Cost and commitment update: Alliance j:#
 for(k in alliance_j[,'id'])	{#
  actors[[k]]$wealth<-max(alliance_j[alliance_i[,'id']==k,'wealth']*#
	(alliance_j[alliance_i[,'id']==k,'wealth']/total_weath_i)* total_weath_i*.25,0)#
	}	#
# Update all commitments	#
	ni<-length(alliance_i[,'id'])#
	nj<-length(alliance_j[,'id'])#
   for(k in 1:ni){#
 	 for(k2 in k:ni){ #
 		 i1<-alliance_i[k,'id']#
 		 i2<-alliance_i[k2,'id']#
 		 actors[[i1]]$commitment[i2]<-min(actors[[i1]]$commitment[i2]+10,100)#
 		 actors[[i2]]$commitment[i1]<-min(actors[[i2]]$commitment[i1]+10,100)#
 	 }#
   }	#
  for(k in 1:nj){#
 	 for(k2 in k:nj){#
 		 j1<-alliance_j[k,'id']#
 		 j2<-alliance_j[k2,'id']#
 		 actors[[j1]]$commitment[j2]<-min(actors[[j1]]$commitment[j2]+10,100)#
 		 actors[[j2]]$commitment[j1]<-min(actors[[j2]]$commitment[j1]+10,100)#
 	 }#
  }#
#
  for(k in 1:ni){#
 	 for(k2 in 1:nj){#
 		 ic<-alliance_i[k,'id']#
 		 jc<-alliance_j[k2,'id']#
 		 actors[[ic]]$commitment[jc]<-max(actors[[ic]]$commitment[jc]-10,0)#
 		 actors[[jc]]$commitment[ic]<-max(actors[[jc]]$commitment[ic]-10,0)#
 	 }#
  }	#
	}#
	# Output: Updated actors#
	return(actors)#
}
runApp('/Users/cuatrooctavos/Desktop/Introduction_1_2/Tribute_Model')
source(paste0(folder_dir,"/Actors/actor_function.R"))
source(paste0(folder_dir,"/Updating_process/alliance_f.R"))
source(paste0(folder_dir,"/Actors/actor_function.R"))
folder_dir<-getwd()
source(paste0(folder_dir,"/Actors/actor_function.R"))
